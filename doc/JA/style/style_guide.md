# Ergスタイルガイド

本項はErgコードのスタイルについてのガイドラインです。
Ergスタイルガイドはコードの可読性を高め、一貫性を保つという目的がありますが、元々はErg formatterの実装のために策定されました。このことからも分かる通り、あなたがコードのフォーマットを行いたいと思った場合、すべきことは基本的に`erg format`を実行するだけです。

したがって、本項はErg formatterがどのような規則でコードをフォーマットするかを定める仕様書とも言えるでしょう。

Ergスタイルガイドは[PEP8](https://peps.python.org/pep-0008)と[Rust Style Guide](https://doc.rust-lang.org/nightly/style-guide/)をベースにしています。
Ergスタイルガイドの基本的な原則は以下の通りです。

* 可読性を重視する
* コンパクトな記述である
* diffが最小限になる

## レイアウト

### 1. インデント

インデントはスペース4つで行います。タブ文字は言語仕様の時点で禁止されています。

インデントは`=`, `->`, `=>`, `do:`, `do!:`, `:`, `\`の後に行えます。

コロン呼び出し形式は文法上何個目の引数からでも使用可能ですが、`match`の典型的な使用例のように1個目の引数の後でのみ使用します。また、コロン呼び出し形式は引数がブロックのときのみ使用します。

```erg
# OK
if! True:
    do!: print! "True"
    do!: print! "False"

_ = match x:
    1 -> ...
    2 -> ...

f 1, 2, 3
```

```erg
# NG
if! True, do!(print! "True"):
    do!: print! "False"

_ = match x, (1 -> ...):
    2 -> ...

f 1:
    2
    3
```

二項演算を`\`で改行する場合は、演算子の後に改行してインデントします。

```erg
# OK
x = 1 + 2 \
    + 3

```

### 2. セパレータ

改行は行末に挿入します。行末には空白文字を挿入しないでください。
セミコロン`;`は、独立した式のセパレータとしては使用しません。レコードのフィールドのセパレータとしてのみ使用します。

## 3. 一行の長さ

一行の長さは80文字以下にしてください。80文字を超える場合はインデント規則、コレクション規則か`\`を使って改行してください。

ただし、リテラル、シンボルは例外として任意の長さが許可されます。

## 4. 空行

クラスまたは関数定義の間は空行を2つ挿入してください。
メソッド定義の間は空行を1つ挿入してください。

その他の部分では、2つ以上の空行を挿入しないでください。
1行の空白は、コードの意味的なグループを分けるために使用可能です。

## 5. インポート

インポートはファイルの先頭に記述します。インポートはアルファベット順ないし使用する文字での一般的な並び順で並べます。インポートするメンバーについても同様です。

モジュールのメンバーを使用したい場合は、展開代入を使用します。

```erg
# NG
foo = import "foo"
{bar; baz} = foo # or `bar, baz = foo.bar, foo.baz`

qux = import("foo").qux
```

```erg
# OK
{bar; baz} = import "foo"
```

数が多くなっても複数のimportには分けません。

```erg
# NG
{bar; baz; qux; quux} = import "foo"
{corge; grault; garply} = import "foo"
```

```erg
# OK
{
    bar; baz; qux; quux;
    corge; grault; garply;
} = import "foo"
```

## 空白

## 行末コンマ

## コメント

`#!`はコンパイラやツールに対して特別な指示を与えるコメントです。実行結果には影響を与えません。

## 命名規則

通常の変数、モジュール名はスネークケースで命名します。
定数は大文字のスネークケースで命名します。型名はパスカルケースで命名します。

```erg
x = "abc"
FOO_BAR = 2
BazQux = Class()
```

変数名の長さに制限はありませんが、あまり長すぎる名前は避けてください。逆に、広範囲で使用されるにもかかわらず短い名前で命名するのも避けてください。
